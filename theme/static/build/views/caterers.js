define(["core/view","underscore","text!templates/caterers.html","./caterer-list-item"],function(e,t,i,r){return e.extend({template:t.template(i),events:{},initialize:function(){var e=this;this.render(),app.collections.caterer.forEach(function(t){e.addCaterer(t)}),app.collections.caterer.on("add",this.addCaterer,this),this.fetchCaterers()},addCaterer:function(e){e.listView?e.listView.show():(e.listView=new r({model:e}),this.caterersList.append(e.listView.$el))},fetchCaterers:function(){var e=(app.filter.get("date"),app.filter.get("area")),t=app.filter.get("category"),i=app.filter.get("price_lower"),r=app.filter.get("price_upper"),a=app.filter.get("capacity_lower"),s=app.filter.get("capacity_upper"),l=app.filter.get("all_female_servers"),c=app.filter.get("arabic_speaking_only");this.filters={area:e,category:t,price_min:i,price_max:r,capacity_min:a,capacity_max:s},l&&(this.filters.all_female_servers="True"),c&&(this.filters.arabic_speaking_only="True"),app.collections.caterer.fetch({data:this.filters,remove:!1,success:function(e,t){var i=t.map(function(e){return e.id});e.models.forEach(function(e){-1==i.indexOf(e.id)?e.listView.hide():e.listView.show()})}})},render:function(){this.html=$(this.template({})),this.$el.html(this.html),this.caterersList=this.$("#caterers-list")}})});