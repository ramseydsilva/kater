define(["core/view","underscore","text!templates/my-cart.html","./main-cart-item"],function(t,e,a,i){return t.extend({template:e.template(a),events:{"click .clear-all":"clearAll","click .add-more":"addMore","change .special-request":"changeSpecialRequest"},initialize:function(){this.model=app.cart,this.render(),app.cart.items.on("add",this.addToCart,this),app.cart.on("change:sub_total",this.changeTotal,this)},addToCart:function(t){t.view||(t.view=new i({model:t})),this.listItem.append(t.view.$el)},changeTotal:function(){this.sub_total.text(app.cart.get("sub_total")+"KD"),this.discount.text(app.cart.get("discount")+"KD"),this.grand_total.text(app.cart.get("grand_total")+"KD"),app.cart.get("sub_total")>0?this.checkoutBtn.removeClass("hidden"):this.checkoutBtn.addClass("hidden")},changeSpecialRequest:function(){app.cart.set("special_request",this.special_request.val())},addMore:function(){url="/caterers",app.router.navigate(url,{trigger:!0})},clearAll:function(){app.cart.clearAll()},render:function(){var t=this;this.html=$(this.template({model:this.model})),this.$el.html(this.html),this.listItem=this.$("#cart-items"),this.sub_total=this.$(".sub_total"),this.special_request=this.$(".special-request"),this.discount=this.$(".discount"),this.grand_total=this.$(".grand_total"),this.checkoutBtn=this.$(".checkoutBtn"),this.model.items.each(function(e){t.addToCart(e)})}})});