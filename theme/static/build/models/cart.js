define(["core/authSync","../collections/cart-item"],function(t,i){return t.Model.extend({defaults:{sub_total:0,discount:0,grand_total:0},initialize:function(){this.items=new i,this.on("change:sub_total",this.calculateGrandTotal,this),this.items.on("reset",this.calculateSubTotal,this),this.items.on("remove",this.calculateSubTotal,this),this.items.on("change:quantity",this.calculateSubTotal,this),this.items.on("add",this.calculateSubTotal,this)},calculateSubTotal:function(){var t=0;this.items.each(function(i){t+=parseInt(i.item.attributes.price)*i.attributes.quantity}),this.set("sub_total",t)},calculateGrandTotal:function(){var t=this.get("sub_total")*((100-this.get("discount"))/100);this.set("grand_total",t)},clearAll:function(){this.items.each(function(t){t.trigger("remove")}),this.items.reset()},getCartItem:function(t){var i=null;return this.items.each(function(e){e.item==t.id&&(i=e)}),i}})});