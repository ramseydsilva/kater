define(["core/router"],function(e){var o=hideBack=hideMap=showHomeButtons=!1,i=$("#job"),t=$("#main-back"),a=$("#map"),n=function(){hideMap?app.promises.mapLoaded.done(function(){a.addClass("hideMap")}):a.removeClass("hideMap"),hideBack?t.hide():t.show()};return e.extend({routes:{"":"home","login/":"login","profile/":"profile","logout/":"logout","join/":"join","jobs/":"jobs","jobs/new/":"jobPost","jobs/new/review/":"jobReview","jobs/:id/":"job","folks/":"folks"},pageNotFoundView:function(e){app.changeTitle(e||"404 Page Not Found")},homeCallback:function(){hideBack=!0,showHomeButtons=!0,n()},jobReviewCallback:function(e){hideFilters=!0,n(),e&&e()},loginCallback:function(e){hideMap=!0,n(),e&&e()},profileCallback:function(e){hideMap=!0,n(),e&&e()},joinCallback:function(e){hideMap=!0,n(),e&&e()},folksCallback:function(e){hideMap=!0,n(),e&&e()},jobsCallback:function(e){hideMap=!0,n(),e&&e()},jobCallback:function(e){app.changeTitle("Job"),app.changePageTitle(e.attributes.title),app.promises.mapLoaded.done(function(){setMap({lat:e.attributes.latitude,lng:e.attributes.longitude})}),n()},jobPostCallback:function(e){if(app.views.home.$el.show(),o=!0,n(),app.views.home){var i=app.collections.category.where({selected:!0});i.length>1&&(selectCategory=i[0],app.views.home.unselectAllCategories(selectCategory))}e&&e()},job:function(e,o){var t=this;if(o||(o=app.collections.job.findWhere({id:parseInt(e)})),o)o.view?(i.html(o.view.html),t.afterViewInit.call(t,"job",o)):require(["views/job"],function(e){o.view=new e({el:document.getElementById("job"),model:o}),t.afterViewInit.call(t,"job",o)});else{var t=this;o=app.collections.job.add({id:e}),o.fetch({error:function(e,o){app.collections.job.remove(e),this.pageNotFoundView(o.status+" "+o.statusText)},success:function(o){t.job(e,o)}})}},logout:function(){app.user.fetch({url:"/api/logout/"})},execute:function(e,o,i){return window.scrollTo(0,0),"jobReview"!=i||app.views.jobPost?(e||(e=this[i]),void(e&&e())):this.navigate("/jobs/new/",!0)}})});